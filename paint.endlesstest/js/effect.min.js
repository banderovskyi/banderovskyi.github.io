function initialiseSlider() {
    if (!$("body").hasClass("slider-loaded") && $("#slider-home").length) {
        sliderHome = new Swiper("#slider-home", {
            direction: "vertical",
            speed: 1500,
            wrapperClass: "slider-wrapper",
            slideClass: "slider-content",
            slideActiveClass: "slider-content-current",
            bulletClass: "nav-indication-item",
            bulletActiveClass: "nav-current",
            loop: !1,
            keyboardControl: !0,
            mousewheelControl: !0,
            grabCursor: !0,
            pagination: ".nav-indication-nb",
            paginationClickable: !1,
            paginationBulletRender: function (a, b, c) {
                return '<div class="nav-indication-item ' + c + '">' + (b + 1) + "</div>"
            },
            onInit: function () {
                $("body").addClass("slider-loaded"), $("html").removeClass("no-slider"), $("body").removeClass("no-slider")
            },
            onSlideChangeStart: function (a) {
                $("body").removeClass("slider-home-active"), $(".slider-content").removeClass("slider-content-change-step2"), setTimeout(function () {
                    $(".slider-content").removeClass("slider-content-change-step1")
                }, 200), 6 != a.activeIndex && $("body").removeClass("download-digital-step1")
            },
            onSlideChangeEnd: function (a) {
                0 == a.activeIndex && ($("body").addClass("slider-home-active"), $("#slider-content-home").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-home").addClass("slider-content-change-step2")
                    }, 500)), 1 == a.activeIndex && ($("#slider-content-chapter-1").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-1").addClass("slider-content-change-step2")
                    }, 500)), 2 == a.activeIndex && ($("#slider-content-chapter-2").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-2").addClass("slider-content-change-step2")
                    }, 500)), 3 == a.activeIndex && ($("#slider-content-chapter-3").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-3").addClass("slider-content-change-step2")
                    }, 500)), 4 == a.activeIndex && ($("#slider-content-chapter-4").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-4").addClass("slider-content-change-step2")
                    }, 500)), 5 == a.activeIndex && ($("#slider-content-chapter-5").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-5").addClass("slider-content-change-step2")
                    }, 500)), 6 == a.activeIndex && ($("#slider-content-chapter-6").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-6").addClass("slider-content-change-step2")
                    }, 500)),
                    7 == a.activeIndex && ($("#slider-content-chapter-7").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-chapter-7").addClass("slider-content-change-step2")
                    }, 500)),
                    8 == a.activeIndex && ($("#slider-content-end").addClass("slider-content-change-step1"), setTimeout(function () {
                        $("#slider-content-end").addClass("slider-content-change-step2")
                    }, 500))
            }
        }), setTimeout(function () {
            nbtotalsliderhome = $(".nav-indication-nb").find(".nav-indication-item").length, $(".nav-indication-total").html(nbtotalsliderhome)
        }, 800);
        var a = new Swiper("#slider-home-nav", {
            speed: 1500,
            wrapperClass: "slider-home-nav-wrapper",
            slideClass: "slide-nav-item",
            bulletClass: "nav-item",
            bulletActiveClass: "nav-item-active",
            grabCursor: !1,
            pagination: ".nav",
            paginationClickable: !0,
            paginationBulletRender: function () {
                return '<li class="nav-item"><div class="nav-bar-container"><div class="nav-bar bg-grey center-vertical"></div><div class="nav-bar-hover bg-corporate-1 center-vertical"></div></div><span class="nav-title"></span></li>'
            }
        });
        sliderHome.params.control = a, a.params.control = sliderHome, $(".go-home").on("click", function (a) {
            a.preventDefault(), sliderHome.slideTo(0, 500, !0)
        }), $(".slide-to-2").on("click", function (a) {
            a.preventDefault(), sliderHome.slideTo(4, 1e3, !0)
        }), $(".slide-to-7").on("click", function (a) {
            a.preventDefault(), sliderHome.slideTo(3, 1e3, !0)
        })
    }
}

function removeSlider() {
    clearTimeout(SliderRemoveTimeout), SliderRemoveTimeout = setTimeout(function () {
        sliderHome.destroy(), $("body").removeClass("slider-loaded")
    }, 500)
}

function OpenMenu() {
    $("html, body").animate({
        scrollTop: 0
    }, 500), $("body").addClass("menu-opened-step1"), setTimeout(function () {
        $("body").addClass("menu-opened-step2")
    }, 100), setTimeout(function () {
        $("body").addClass("menu-opened-step3")
    }, 500), setTimeout(function () {
        $("body").addClass("menu-opened-step4")
    }, 800)
}

function CloseMenu() {
    $("body").removeClass("menu-opened-step4"), $("body").removeClass("menu-opened-step3"), setTimeout(function () {
        $("body").removeClass("menu-opened-step2")
    }, 400), setTimeout(function () {
        $("body").removeClass("menu-opened-step1")
    }, 1300)
}

function CloseAuthor() {
    setTimeout(function () {
        $("body").removeClass("author-opened-step4"), $("body").removeClass("author-opened-step3")
    }, 500), setTimeout(function () {
        $("body").removeClass("author-opened-step2")
    }, 800), setTimeout(function () {
        $("html, body").removeClass("author-opened-step1")
    }, 2800)
}

function ChangePage() {
    $("body").addClass("page-transition-step1"), setTimeout(function () {
        $("body").addClass("page-transition-step2")
    }, 10), setTimeout(function () {
        CloseMenu()
    }, 1500), setTimeout(function () {
        window.location.href = $thislink.attr("href")
    }, 1500), setTimeout(function () {
        $("body").removeClass("page-transition-step2")
    }, 5500), setTimeout(function () {
        $("body").removeClass("page-transition-step1")
    }, 6500)
}

function sceneParallax() {
    if ($(".scene-parallax").length) {
        var a = $(".scene-parallax");
        (resize = function () {
            a[0].style.width = window.innerWidth + "px", a[0].style.height = window.innerHeight + "px"
        })(), window.onresize = _.debounce(resize, 200), window.onscroll = _.debounce(resize, 200), a.parallax()
    }
}

function onScroll() {
    $(".scroll-anim").length && $(".scroll-anim").each(function () {
        $(this).scrollTop() + $(this).offset().top < $(window).scrollTop() + $(window).height() ? $(this).addClass("scroll-anim-active") : $(this).removeClass("scroll-anim-active")
    }), $(".scroll-anim-fast").length && $(".scroll-anim-fast").each(function () {
        $(this).scrollTop() + $(this).offset().top < $(window).scrollTop() + $(window).height() + 100 ? $(this).addClass("scroll-anim-active") : $(this).removeClass("scroll-anim-active")
    })
}

function fitAll() {
    windoww = $(window).width(), windowh = $(window).height(), $("body#emersion").length && (windoww < 810 || windowh < 600 ? ($("body").hasClass("slider-loaded") && removeSlider(), $("html").addClass("no-slider"), $("body").addClass("no-slider"), $(".slide-to-2").on("click", function (a) {
        a.preventDefault(), $("html, body").animate({
            scrollTop: $("#slider-content-chapter-1").offset().top
        }, 400)
    }), $(".slide-to-7").on("click", function (a) {
        a.preventDefault(), $("html, body").animate({
            scrollTop: $("#slider-content-end").offset().top
        }, 400)
    })) : initialiseSlider()), $("#download-book-wrapper").length && (downloadbookh = windowh / 2.2, $("#download-book-wrapper").css("height", downloadbookh)), $("#shop-wrapper").length && (setTimeout(function () {
        shoph = $("#shop-wrapper").height(), shopcontenth = $("#shop-align > .row").height()
    }, 500), setTimeout(function () {
        shopcontenth + 180 > windowh ? $("#shop-wrapper").addClass("big-height") : $("#shop-wrapper").removeClass("big-height")
    }, 550))
}

function fitIndiceScroll() {
    $("#shop-wrapper").length && (setTimeout(function () {
        shoph = $("#shop-wrapper").height(), shopcontenth = $("#shop-align > .row").height()
    }, 350), setTimeout(function () {
        shopcontenth + 180 > windowh ? $("#indice-scroll").hide() : $("#indice-scroll").show()
    }, 400))
}
var windoww = 0,
    windowh = 0,
    nbtotalsliderhome = 0,
    downloadbookh = 0,
    shoph = 0,
    shopcontenth = 0,
    calculateh = 0,
    introh = 0,
    madefortitleminh = 0,
    madeforheaderh = 0,
    madefortexth = 0,
    sliderHome = null,
    SliderRemoveTimeout = null;
$(window).on("load", function () {
        $("body:not(#emersion)").addClass("page-loading-step1"), setTimeout(function () {
            $("body:not(#emersion)").addClass("page-loading-step2")
        }, 400), setTimeout(function () {
            $("body:not(#emersion)").addClass("page-loading-step3")
        }, 800), setTimeout(function () {
            $("body:not(#emersion)").addClass("page-loading-step4")
        }, 1200)
    }),

    $(document).ready(function () {
        if ($(window).on("resize", function () {
                fitAll(), 
                fitIndiceScroll()
            }), fitAll(), 
            fitIndiceScroll(), $(".edd_terms_links").on("click", function () {
                fitIndiceScroll()
            }), $(window).on("scroll", function () {
                onScroll()
            }), onScroll(), $("#loading-text").length) {
            new Typed("#loading-text", {
                stringsElement: "#loading-text-strings",
                typeSpeed: 60,
                startDelay: 2e3,
                loop: !1,
                onComplete: function () {
                    $("body").addClass("page-loading-step1"), setTimeout(function () {
                        $("body").addClass("page-loading-step2")
                    }, 1400), setTimeout(function () {
                        $("body").addClass("page-loading-step3")
                    }, 1800), setTimeout(function () {
                        $("body").addClass("page-loading-step4"), $("#slider-home").length && ($("body").addClass("slider-home-active"), $("#slider-content-home").addClass("slider-content-change-step1"), setTimeout(function () {
                            $("#slider-content-home").addClass("slider-content-change-step2")
                        }, 500))
                    }, 2400)
                }
            })
        }
        if (sceneParallax(), $(".btn-download-digital").on("click", function (a) {
                $("body").addClass("download-digital-step1"), a.preventDefault()
            }), $(".open-menu").on("click", function () {
                OpenMenu()
            }), $(".close-menu").on("click", function (a) {
                CloseMenu(), a.preventDefault()
            }), $("body").on("click", ".change-page", function (a) {
                $thislink = $(this), ChangePage(), a.preventDefault()
            }), $("body").on("click", ".go-home", function (a) {
                $("body#emersion").length ? (a.preventDefault(), CloseMenu(), CloseAuthor()) : ($("body").addClass("go-home-step1"), $thislink = $(this), ChangePage(), a.preventDefault(), setTimeout(function () {
                    $("body").removeClass("go-home-step1")
                }, 4e3))
            }), $("body#buy").on("click", ".slide-to-bottom", function (a) {
                $("html, body").animate({
                    scrollTop: shoph
                }, 1e3), a.preventDefault()
            }), $(".open-author").on("click", function (a) {
                a.preventDefault(), $("body#author").length ? (CloseMenu(), CloseAuthor()) : ($("#author-wrapper").load("/?page_id=45 #author-wrapper > *"), $("html, body").addClass("author-opened-step1"), setTimeout(function () {
                    $("body").addClass("author-opened-step2")
                }, 100), setTimeout(function () {
                    OpenMenu()
                }, 300), $(document).ajaxComplete(function () {
                    setTimeout(function () {
                        $("body").addClass("author-opened-step3"), sceneParallax()
                    }, 400), setTimeout(function () {
                        $("body").addClass("author-opened-step4")
                    }, 900)
                }))
            }), $(".close-author").on("click", function (a) {
                a.preventDefault(), CloseMenu(), CloseAuthor()
            }), $(".open-modal").on("click", function (a) {
                a.preventDefault(), $("body").addClass("modal-open-step1"), setTimeout(function () {
                    $("body").addClass("modal-open-step2")
                }, 100), setTimeout(function () {
                    $("body").addClass("modal-open-step3")
                }, 700)
            }), $(".open-modal-emersion-print").on("click", function () {
                $("body").addClass("modalbookprint-open-step1"), Modernizr.touch || $("#modal-book-print .mailpoet_text").length && $("#modal-book-print .mailpoet_text").focus()
            }), $(".close-modal").on("click", function (a) {
                a.preventDefault(), $("body").removeClass("modal-open-step3"), setTimeout(function () {
                    $("body").removeClass("modal-open-step2")
                }, 300), setTimeout(function () {
                    $("body").removeClass("modal-open-step1"), $("body").removeClass("modalbookprint-open-step1")
                }, 1300)
            }), ($(".row-form").length || $(".mailpoet_form").length) && ($("div.mailpoet_form").addClass("row-form"), $('.row-form input[type="text"], .row-form textarea, .mailpoet_form input[type="text"], .mailpoet_form textarea').each(function () {
                $thiselem = $(this), "" == $thiselem.val() ? $thiselem.parent().removeClass("focus-label") : $thiselem.parent().addClass("focus-label")
            }), $(".row-form input, .row-form textarea, .mailpoet_form input, .mailpoet_form textarea").on("focusin", function () {
                $(this).parent().addClass("focus-label")
            }), $(".row-form input, .row-form textarea, .mailpoet_form input, .mailpoet_form textarea").on("focusout", function () {
                "" == $(this).val() && $(this).parent().removeClass("focus-label")
            })), $("#edd_checkout_wrap .edd_empty_cart").length || $("body > .woocommerce .cart-empty").length ? $("html").addClass("html-panier-vide") : $("html").removeClass("html-panier-vide"), $("#book-info #edd_purchase_receipt + h3").length) {
            var b = $("#book-info #edd_purchase_receipt + h3").text().replace("Produits", "T\xe9l\xe9chargements");
            $("#book-info #edd_purchase_receipt + h3").text(b)
        }
        if ($("#mailchimp_woocommerce_newsletter + label.checkbox").length) {
            var c = $("#mailchimp_woocommerce_newsletter + label.checkbox").text().replace("Subscribe to our newsletter", "Inscription \xe0 la newsletter");
            $("#mailchimp_woocommerce_newsletter + label.checkbox").text(c)
        }
        if ($("#edd_purchase_receipt").length) {
            var d = $("#edd_purchase_receipt th:first-child").text().replace(":", "");
            $("#edd_purchase_receipt th:first-child").text(d);
            var e = $("#edd_purchase_receipt tr:nth-child(1) td:first-child").text().replace(":", "");
            $("#edd_purchase_receipt tr:nth-child(1) td:first-child").text(e);
            var f = $("#edd_purchase_receipt tr:nth-child(2) td:first-child").text().replace(":", "");
            $("#edd_purchase_receipt tr:nth-child(2) td:first-child").text(f);
            var g = $("#edd_purchase_receipt tr:nth-child(3) td:first-child").text().replace(":", "");
            $("#edd_purchase_receipt tr:nth-child(3) td:first-child").text(g);
            var h = $("#edd_purchase_receipt tr:nth-child(4) td:first-child").text().replace(":", "");
            $("#edd_purchase_receipt tr:nth-child(4) td:first-child").text(h);
            var i = $("#edd_purchase_receipt tr:nth-child(5) td:first-child").text().replace(":", "");
            $("#edd_purchase_receipt tr:nth-child(5) td:first-child").text(i)
        }

        // custom js 
        $('.chapter-1-slider').slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            arrow: true,
            prevArrow: $('.chapter-1-slider .arrows-0 .arrow-prev'),
            nextArrow: $('.chapter-1-slider .arrows-0 .arrow-next'),
            responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 990,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        });
        $('.chapter-new-2-slider').slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            arrow: true,
            asNavFor: '.chapter-new-2-slider-text',
            prevArrow: $('.chapter-new-2 .arrows-0 .arrow-prev'),
            nextArrow: $('.chapter-new-2 .arrows-0 .arrow-next'),
            responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 990,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        });
        $('.chapter-new-2-slider-text').slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            arrow: false,
            asNavFor: '.chapter-new-2-slider',
            responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 990,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        });


        $('.chapter-2-slider').slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            arrow: true,
            adaptiveHeight: true,
            prevArrow: $('.chapter-2-slider-wrap .arrows-0 .arrow-prev'),
            nextArrow: $('.chapter-2-slider-wrap .arrows-0 .arrow-next'),
            responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 990,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        });

        $('.chapter-3-slider').slick({
            infinite: true,
            slidesToShow: 2,
            slidesToScroll: 1,
            arrow: true,
            prevArrow: $('.arrows-1 .arrow-prev'),
            nextArrow: $('.arrows-1 .arrow-next'),
            responsive: [{
                    breakpoint: 1170,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 1,
                    }
                },
                {
                    breakpoint: 990,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        });

        $('.chapter-4-slider').slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            arrow: true,
            prevArrow: $('.chapter-4-slider-wrap .arrows-0 .arrow-prev'),
            nextArrow: $('.chapter-4-slider-wrap .arrows-0 .arrow-next'),
            responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 990,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        }).on('setPosition', function (event, slick) {
            slick.$slides.css('height', slick.$slideTrack.height() + 'px');
        });
        $('.chapter-5-slider').slick({
            infinite: true,
            slidesToShow: 1,
            slidesToScroll: 1,
            arrow: true,
            prevArrow: $('.chapter-5-slider-wrap .arrows-0 .arrow-prev'),
            nextArrow: $('.chapter-5-slider-wrap .arrows-0 .arrow-next'),
            responsive: [{
                breakpoint: 1170,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1,
                }
            },
            {
                breakpoint: 990,
                settings: {
                    slidesToShow: 1,
                    slidesToScroll: 1
                }
            }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        }).on('setPosition', function (event, slick) {
            slick.$slides.css('height', slick.$slideTrack.height() + 'px');
        });


        $('.chapter-7-slider').slick({
            infinite: true,
            slidesToShow: 4,
            slidesToScroll: 1,
            arrow: true,
            prevArrow: $('.arrows-2 .arrow-prev'),
            nextArrow: $('.arrows-2 .arrow-next'),
            responsive: [{
                    breakpoint: 1170,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 1,
                        infinite: true

                    }
                },
                {
                    breakpoint: 990,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]
        });

        $('.news-list').slick({
            infinite: false,
            slidesToShow: 2,
            slidesToScroll: 1,
            arrow: true,
            prevArrow: $('.news-arrows .news-arrow--prev'),
            nextArrow: $('.news-arrows .news-arrow--next'),
            responsive: [{
                    breakpoint: 990,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
                // You can unslick at a given breakpoint now by adding:
                // settings: "unslick"
                // instead of a settings object
            ]

        });

        // INPUT MASK // 

        $('input[type="tel"]').mask('+7 (000) 000-00-00', {
            clearIfNotMatch: true
        });
        $('input[type="tel"]').focus(function () {
            $(this).val('+7 (');
            if ($(this).val() == '') {

            }
        });

        /// MODAL WINDOWS

        $('.overlay, .close').click(function () {
            $(".modal-cont").animate({
                    opacity: 0,
                    top: "50%"
                }, 200,
                function () {
                    $(this).css('z-index', '-1');
                    $('.overlay').fadeOut(400);
                }
            );
        });

        $('.modal-run').click(function (event) {
            event.preventDefault();
            let dataId = $(this).attr("data-id")
            let modalH2 = $(".modal-cont-" + dataId).height();

            $(".modal-cont-" + dataId).css({
                'marginTop': -modalH2 / 2
            });
            $(".overlay").fadeIn(600, function () {
                $(".modal-cont-" + dataId)
                    .css('z-index', '9999')
                    .css('top', '50%')
                    .animate({
                        opacity: 1
                    }, 200)
            });
        });

        $('form').submit(function (e) {
            var $form = $(this);
            $.ajax({
                type: $form.attr('method'),
                url: '/post.php',
                data: $form.serialize()
            }).done(function () {
                $form[0].reset();
                $('.overlay').fadeIn(600);
                let modalH2 = $(".modal-cont-2").height();
                $(".modal-cont-1").animate({ opacity: 0, top: "50%" }, 200,);
                $(".modal-cont-2").css({
                    'marginTop': -modalH2 / 2
                });
                $(".modal-cont-2").css('z-index', '9999')
                    .animate({ opacity: 1, top: "50%" }, 200)
    
                console.log('success');
               
            }).fail(function () {
                console.log('fail');
            });
            //отмена действия по умолчанию для кнопки submit
            e.preventDefault();
        });


    });